name: Deploy docs
on:
  workflow_dispatch: {}
permissions:
  contents: write
jobs:
  deploy_docs:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout repository
      uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8
    - name: Determine docs-only push
      id: docs-only
      run: "if [ \"${{ github.event_name }}\" != \"push\" ]; then\n  echo \"skip=false\"\
        \ >> \"$GITHUB_OUTPUT\"\n  exit 0\nfi\nset -euo pipefail\nbefore=\"${{ github.event.before\
        \ }}\"\nsha=\"${{ github.sha }}\"\nchanged_files=$(git diff --name-only \"\
        $before\" \"$sha\" || true)\nnon_docs=$(echo \"$changed_files\" | grep -vE\
        \ '^(docs/|mkdocs.yml$)' || true)\nif [ -n \"$non_docs\" ]; then\n  echo \"\
        skip=true\" >> \"$GITHUB_OUTPUT\"\nelse\n  echo \"skip=false\" >> \"$GITHUB_OUTPUT\"\
        \nfi\n"
    - name: Setup uv
      if: steps.docs-only.outputs.skip != 'true'
      uses: astral-sh/setup-uv@d4b2f3b6ecc6e67c4457f6d3e41ec42d3d0fcb86
      with:
        enable-cache: true
    - name: Install dependencies
      if: steps.docs-only.outputs.skip != 'true'
      run: make sync
    - name: Deploy docs
      if: steps.docs-only.outputs.skip != 'true'
      run: make deploy-docs
